extends ../../layouts/default.pug
include ../../mixins/fillterStatus.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/form-change-multi.pug
include ../../mixins/show-alert.pug
block main
  
  .container.my-4
    +showAlert(3000)        
    // Thanh tìm kiếm & lọc
    .row.mb-3
      .col-md-7
        +searchForm(keyword)
      .col-md-5
        select.form-select
          option(value="") Tất cả danh mục
          option Áo
          option Quần
          option Phụ kiện
    .row.mb-3
        .col-md-4 
                +fillterStatus(fillerButton)
        .col-md-8 
          .d-flex.justify-content-end
            a(
              class="btn btn-success"
              addProduct
              href=`${prefixAdmin}/products/create`
            ) Thêm sản phẩm <i class="fa-solid fa-plus"></i>
    .row.mb-3 
      div.col-3.d-flex
        <select id="sort" name="sort" class="form-select form-select-sm" style="min-width: 220px;" sort-select>
          <option option-sort value="position-desc" >Vị trí giảm dần</option>
          <option option-sort value="position-asc">Vị trí tăng dần</option>
          <option option-sort value="price-desc"    >Giá giảm dần</option>
          <option option-sort value="price-asc"  >Giá tăng dần</option>
          <option option-sort value="title-asc"      >Tên A → Z</option>
          <option option-sort value="title-desc"     >Tên Z → A</option>
        </select>
        .btn.btn-danger.mx-2(btn-reset) Clear
        

    // Bảng sản phẩm
    .card.shadow
      +form-change-multi(`${prefixAdmin}/products/change-multi?_method=PATCH`)
      .card-body
        table.table.table-hover.align-middle(checkbox-multi)
          thead.table-dark
            tr
              th 
                input(type="checkbox" name="checkall")  
              th Ảnh
              th Tên sản phẩm
              th Giá
              th Tồn kho
              th Vị trí
              th Trạng thái
              th Hành động
          tbody
            each item in productsList
              tr
                td  
                  input(type="checkbox" name="id" value=item.id)
                td
                  img.rounded.img-fluid(
                    alt="product" 
                    src=`${item.thumbnail}`
                    style="height:50px; width:50px"
                    )
                td #{item.title}
                td #{item.price}$
                td #{item.stock} Cái
                td
                  input(
                    style="width: 70px"
                    type="number"
                    min="1"
                    value=`${item.position}`
                    name="position"
                  )
                td
                  if ( item.status == "active")
                    span.badge.bg-success(
                      data-status=item.status
                      data-id=item.id 
                      btn-change-status
                    ) Hoạt động
                  else 
                    span.badge.bg-warning(
                      data-status=item.status
                      data-id=item.id 
                      btn-change-status
                    ) Ngưng hoạt động 
                td
                  a.btn.btn-warning.btn-sm(href=`${prefixAdmin}/products/edit/${item._id}`)
                    i.fas.fa-edit
                  a.btn.btn-danger.btn-sm(href="#" button-delete data-id=item._id )
                    i.fas.fa-trash
                  a.btn.btn-info.btn-sm(href=`${prefixAdmin}/products/detail/${item._id}` button-detail)
                    i.fa-solid.fa-circle-info
            
            
        // Phân trang mixin
        +pagination(pagination)
        form(
          action="",
          method="POST"
          id="form-change-status"
          data-path=`${prefixAdmin}/products/change-status` 
        ) 
        form(
          action="",
          method="POST"
          id="form-delete-item"
          data-path=`${prefixAdmin}/products/deleteItem` 
        ) 
        script(src="/admin/js/products.js") 
        